# Gitleaks configuration for Knowledge Vault
# See: https://github.com/gitleaks/gitleaks

title = "Knowledge Vault Security Rules"

[extend]
# Use default gitleaks rules as base
useDefault = true

# Custom rules for knowledge documentation
[[rules]]
id = "internal-url"
description = "Internal/private network URL detected"
regex = '''https?://(192\.168\.|10\.|172\.(1[6-9]|2[0-9]|3[01])\.|localhost:)'''
keywords = ["192.168", "localhost", "10.", "172."]

[[rules]]
id = "pii-email-name"
description = "Name and email combination (PII)"
regex = '''[A-Z][a-z]+\s+[A-Z][a-z]+\s+<[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}>'''
keywords = ["<", "@", ">"]

[[rules]]
id = "inline-password"
description = "Inline password assignment"
regex = '''(?i)(password|passwd|pwd)\s*[:=]\s*["'][^"']{8,}["']'''
keywords = ["password", "passwd", "pwd"]

# Allowlist for false positives
[allowlist]
description = "Global allowlist for false positives"
paths = [
  '''node_modules/''',
  '''\.git/''',
  '''\.obsidian/''',
  '''public/'''
]

# Example code patterns (common in technical documentation)
regexTarget = "line"
regexes = [
  # Placeholder/example patterns
  '''sk-[xX]{48}''',
  '''YOUR[_-]?API[_-]?KEY''',
  '''<YOUR[_-]?[A-Z_]+>''',
  '''EXAMPLE[_-]?[A-Z_]+''',
  '''xxx+''',
  '''API_KEY_HERE''',
  '''your-api-key-here''',
  '''sk-xxxxxxxx''',
  '''\*\*\*redacted\*\*\*''',
]

[[allowlist.paths]]
description = "Template files with placeholders"
paths = [
  '''obsidian/templates/'''
]
